data1 = [
147	4.82982983	3.128128128	6.328828829
148	2.887887888	4.74974975	6.028528529
149	0.985985986	2.177177177	8.115615616
150	1.376376376	2.967967968	5.217717718
151	7.822822823	6.931931932	0
152	3.288288288	4.439439439	6.809309309
153	2.817817818	8.923923924	0
154	1.276276276	2.587587588	4.331831832
155	2.317317317	2.547547548	5.773273273
156	0.815815816	1.856856857	3.445945946
157	2.097097097	2.117117117	5.097597598
158	3.048048048	1.586586587	2.785285285
159	3.858858859	9.934934935	0
160	7.912912913	0.835835836	5.352852853
161	7.932932933	7.232232232	7.845345345
162	1.676676677	2.677677678	5.803303303
163	1.466466466	3.138138138	8.235735736
165	1.076076076	5.48048048	0
166	1.906906907	2.487487487	7.004504505
167	4.62962963	7.642642643	0
168	0.425425425	2.037037037	4.316816817
169	2.227227227	2.657657658	6.944444444
];

data2 = [
147	4.82982983	3.128128128	6.328828829
148	2.887887888	4.74974975	6.028528529
149	0.985985986	2.177177177	8.115615616
150	1.376376376	2.967967968	5.217717718
152	3.288288288	4.439439439	6.809309309
154	1.276276276	2.587587588	4.331831832
155	2.317317317	2.547547548	5.773273273
156	0.815815816	1.856856857	3.445945946
157	2.097097097	2.117117117	5.097597598
158	3.048048048	1.586586587	2.785285285
160	7.912912913	0.835835836	5.352852853
161	7.932932933	7.232232232	7.845345345
162	1.676676677	2.677677678	5.803303303
163	1.466466466	3.138138138	8.235735736
166	1.906906907	2.487487487	7.004504505
168	0.425425425	2.037037037	4.316816817
169	2.227227227	2.657657658	6.944444444
];


data3 = [
110	3.398398398	2.987987988	8.025525526
111	0.405405405	1.236236236	7.815315315
112	1.887387387	1.067567568	9.424424424
113	1.806306306	1.761261261	6.331331331
114	0.310810811	0.490990991	4.62962963
115	0.698198198	1.797297297	8.213213213
116	1.094594595	2.689189189	7.812812813
117	0.256756757	0.265765766	2.537537538
119	1.004504505	0.617117117	6.301301301
120	0.065065065	0.255255255	2.13963964
122	0.275275275	0.265265265	4.587087087
123	0.707207207	0.247747748	3.548548549
124	0.545545546	0.675675676	4.466966967
125	1.166666667	1.040540541	0
126	0.806306306	1.310810811	7.542542543
127	0.635135135	1.04954955	0
128	0.545045045	1.085585586	7.022022022
129	1.004504505	2.265765766	0
135	1.364864865	1.211711712	6.821821822
136	0.608108108	2.959459459	9.064064064	
139	3.554054054	3.896396396	8.783783784
140	2.184684685	1.283783784	6.341341341
141	0.166666667	0.328828829	6.311311311
];

data4 = [
110	3.398398398	2.987987988	8.025525526
111	0.405405405	1.236236236	7.815315315
112	1.887387387	1.067567568	9.424424424
113	1.806306306	1.761261261	6.331331331
114	0.310810811	0.490990991	4.62962963
115	0.698198198	1.797297297	8.213213213
116	1.094594595	2.689189189	7.812812813
117	0.256756757	0.265765766	2.537537538
119	1.004504505	0.617117117	6.301301301
120	0.065065065	0.255255255	2.13963964
121	0.752252252	0	2.847847848
122	0.275275275	0.265265265	4.587087087
123	0.707207207	0.247747748	3.548548549
124	0.545545546	0.675675676	4.466966967
126	0.806306306	1.310810811	7.542542543
128	0.545045045	1.085585586	7.022022022
135	1.364864865	1.211711712	6.821821822
136	0.608108108	2.959459459	9.064064064	
139	3.554054054	3.896396396	8.783783784
140	2.184684685	1.283783784	6.341341341
141	0.166666667	0.328828829	6.311311311
];

data5 = [
201	1.346346346	7.274774775	3.468468468		
211	0.835835836	0           7.502502503			
215	0.675675676	5.187687688	3.498498498		
220	0.225225225	1.253753754	0.115115115		
225	3.358358358	10.33783784	4.91991992			
230	1.686686687	10.78828829	4.88988989		
235	1.116116116	11.53903904	0		
240	1.986986987	8.310810811	3.228228228	
245	4.56956957	0           8.123123123			
248	4.069069069	5.848348348	4.85985986		
251	2.057057057	7.995495495	7.252252252		
255	0.435435435	8.656156156	7.822822823
258	1.216216216	0           7.892892893							
270	1.046046046	3.475975976	1.286286286			
275	0.245245245	0.968468468	0.265265265
];

data6 = [
216	0.455455455	0.683183183	0.685685686		
241	3.478478478	2.725225225	3.768768769		
246	0.355355355	0.457957958	0.125125125			
249	2.627627628	2.86036036	2.427427427
];

%% 226 ms

sub_num226 = data1(:,1);
steady226 = data1(:,2);
pulse226 = data1(:,3);

ratio1_226 = mean(steady226./pulse226);
ratio2_226 = mean(steady226)/mean(pulse226);

a226 = (pulse226*.226 - steady226*.226) ./ steady226;
a_mean_226 = mean(a226);

br_226 = .226/(a_mean_226 + .226);

% 90 ms
sub_num90 = data2(:,1);
steady90 = data2(:,2);
pulse90 = data2(:,4);

ratio1_90 = mean(steady90./pulse90);
ratio2_90 = mean(steady90)/mean(pulse90);

a90 = (pulse90*.09 - steady90*.09) ./ steady90;
a_mean_90 = mean(a90);

br_90 = .09/(a_mean_90 + .09);


%% first data section

sub_num226_2 = data3(:,1);
steady226_2 = data3(:,2);
pulse226_2 = data3(:,3);

ratio1_226_2 = mean(steady226_2./pulse226_2);
ratio2_226_2 = mean(steady226_2)/mean(pulse226_2);

a226_2 = (pulse226_2*.226 - steady226_2*.226) ./ steady226_2;
a_mean_226_2 = mean(a226_2);

br_226_2 = .226/(a_mean_226_2 + .226);

% 26 ms
sub_num26 = data4(:,1);
steady26 = data4(:,2);
pulse26 = data4(:,4);

ratio1_26 = mean(steady26./pulse26);
ratio2_26 = mean(steady26)/mean(pulse26);

a26 = (pulse26*.026 - steady26*.026) ./ steady26;
a_mean_26 = mean(a26);

br_26 = .026/(a_mean_26 + .026);

%% second data section

sub_num50 = data5(:,1);
steady50 = data5(:,2);
pulse50 = data5(:,3);

ratio1_50 = mean(steady50./pulse50);
ratio2_50 = mean(steady50)/mean(pulse50);

a50 = (pulse50*.050 - steady50*.050) ./ steady50;
a_mean_50 = mean(a50);

br_50 = .050/(a_mean_50 + .050);

% 140 ms
sub_num140 = data5(:,1);
steady140 = data5(:,2);
pulse140 = data5(:,4);

ratio1_140 = mean(steady140./pulse140);
ratio2_140 = mean(steady140)/mean(pulse140);

a140 = (pulse140*.140 - steady140*.140) ./ steady140;
a_mean_140 = mean(a140);

br_140 = .140/(a_mean_140 + .140);

%% third data section

sub_num500 = data6(:,1);
steady500 = data6(:,2);
pulse500 = data6(:,3);

ratio1_500 = mean(steady500./pulse500);
ratio2_500 = mean(steady500)/mean(pulse500);

a500 = (pulse500*.500 - steady500*.500) ./ steady500;
a_mean_500 = mean(a500);

br_500 = .500/(a_mean_500 + .500);

% 1000 ms
sub_num1000 = data6(:,1);
steady1000 = data6(:,2);
pulse1000 = data6(:,4);

ratio1_1000 = mean(steady1000./pulse1000);
ratio2_1000 = mean(steady1000)/mean(pulse1000);

a1000 = (pulse1000*1 - steady1000*1) ./ steady1000;
a_mean_1000 = mean(a1000);

br_1000 = 1/(a_mean_1000 + 1);

%%

old_a = .245;
br_old = .226/(old_a + .226);

tspan = .001:.001:10;
br_fast = tspan./(.2+tspan);

figure (9)
semilogx(tspan,br_fast,'k',[.09 .226],[br_90 br_226],'bo',[.026 .226],[br_26 br_226_2],'b^',.226,br_old,'bs',[.050 .140], [br_50 br_140],'rd', [.500 1], [br_500 br_1000], 'rd','LineWidth',2)
ylabel('I_e_f_f/max(I_r_e_l)','FontSize',14)
xlabel('\Delta T of I_r_e_l (s)','FontSize',14)
legend('Blondel-Rey','Spring Data T1','Spring Data T2','Fall Data','Summmer Data','Location','NorthWest')
grid
set(gca, 'FontSize', 16)


%%

old_a = .245;
br_old = .226/(old_a + .226);

tspan = .001:.001:10;
br_fast = tspan./(.2+tspan);

br_mod = tspan./(old_a+tspan);

figure (10)
semilogx(tspan,br_fast,'k',.226,br_old,'bs',tspan, br_mod,'r--','LineWidth',2)
ylabel('I_e_f_f/max(I_r_e_l)','FontSize',14)
xlabel('\Delta T of I_r_e_l (s)','FontSize',14)
legend('Blondel-Rey','Exp. Data','Mod. B-R','Location','NorthWest')
grid
set(gca, 'FontSize', 16)

